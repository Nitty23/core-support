<header>
    <nav class="cs-header">
        <div class="navbar">
            <div class="hamburger-container">
                <button id="mobile-nav-btn" class="nav-btn show-for-small-only">
                    <i class="fas fa-bars search-icons"></i>
                </button>
            </div>
            <div class="logo-container ">
                <a href="{{page.tohome}}" class="">
                    <img  class="logo" src="/e2/images/rv7/core-support/ui-media/coresupport_logo.svg"
                        srcset="/e2/images/rv7/core-support/ui-media/coresupport_logo.svg 2500w, 
                                /e2/images/rv7/core-support/ui-media/coresupport_mobile_logo.svg 768w"
                    alt="CORE Support Logo"/>
                </a>
            </div>
            <div style="width:33%; display: flex; justify-content: flex-end;">
                <button id="search-btn" class="nav-btn">
                    <i class="fas fa-search search-icons"></i>
                </button> 
            </div>
            
        </div>
    </nav>
    <div class="search-mast hider" id="search-sect">
        <div class="search-btn-container">
            <div class="dropdown-searchbox">
                <input type="search" id="search-input" aria-label="Search through site content" placeholder="search ...">
                <i class="fas fa-search search-icons"></i>
            </div>
        </div>            
    </div>
    <nav id="mobile-dropdown-menu" class="hider show-for-small-only mobile-dropdown-container">
        <ul class="vertical menu accordion-menu mobile-accord" data-accordion-menu>
            {% for topic in site.data.toc.support_toc %}
                    <li style="padding:0px 10px">                             
                        <a href="#" class="mobile-title-pills article-sidenav-link">{{ topic.title }}<span class="title-pill-carrot">&#x2303;</span></a>
                        <hr class="mobile-hr">
                        <ul class="menu vertical nested">
                {% for subtopic in topic.subtopics %}  
                            <li class="mobile-li">
                                <a href="{{page.tohome}}topics/#{{ subtopic.id }}" class="mobile-sec-pills article-sidenav-link">{{ subtopic.title }}</a>
                            </li>
                            {% if forloop.last == true %}
                            <hr class="mobile-hr" style="margin-left: -3%;">
                            {% endif %}
                {% endfor %}
                        </ul>                       
                    </li>
            {% endfor %}
            </ul>
        </div>            
    </nav>    
</header>

<div class="main" role="main">
    <div class="container">
        <div class="inner-container">
            <div id="topic-sect-spacer" class="topicspan">&nbsp;</div>
            <div class="row ">
                <aside class="column large-3 medium-4 topics-pill-menu hide-for-small-only">
                    <nav>
                    {% for topic in site.data.toc.support_toc %}
                        <ul class="vertical menu accordion-menu" data-accordion-menu>
                            <li>                                
                                <a href="#" class="title-pill">{{ topic.title }}<span class="title-pill-carrot hider">&#x2303;</span></a>
                                <ul class="menu vertical nested">
                        {% for subtopic in topic.subtopics %}  
                                    <li>
                                        <a href="./#{{ subtopic.id }}" class="secondary-pill">{{ subtopic.title }}</a>
                                    </li>
                        {% endfor %}
                                </ul>
                            </li>
                        </ul>
                    {% endfor %}
                    </nav>                 
                </aside>
                
                <div class="column large-9 medium-8 small-12 medium-offset-4 large-offset-3">
                    <div class="topics-content">
                        {% include topic_generator.html %}
                    </div>
                </div> <!-- End of Second column here -->
            </div>
        </div> <!-- End of inner containter here -->
        {% include cantfind.html %}
    </div> <!-- End of outer containter here -->
</div> <!-- end of main -->

<script type="text/javascript" src="/e2/js/rv7/3rdparty/jquery/jquery-3.3.1(f).min.js"></script>
<script type="text/javascript" src="/e2/js/rv7/3rdparty/foundation/foundation-6.5.1(accordion_grid_vis_embed_only).min.js"></script>
<script>$(document).foundation();</script>
<script type="text/javascript">
    // Activates menu item selected fron URL #
    // $(document).ready(function(){
    //     var targetId = location.hash;
    //     var x = document.querySelectorAll("a.title-pill");
    //     var a = document.querySelectorAll("a.secondary-pill");
    //     var y, b;
    //     for (y in x){
    //         if(x[y].hash === targetId){
    //         x[y].style.fontWeight = "bold";
    //         x[y].className = "title-pill is-active-parent";
    //         $( x[y] ).find( this, '.title-pill-carrot' ).toggleClass('hider');
    //         $( x[y] ).siblings( 'ul' ).addClass("is-active");
    //         }
    //     }
    //     for (b in a){
    //         if(a[b].hash === targetId){
    //         a[b].className = "secondary-pill is-active";
    //         $( a[b] ).parents( 'ul' ).addClass("is-active");
    //         }
    //     }
    // });
    // Hides all dropdown menus except clicked
    $('.title-pill').click(function(e){
        $('.accordion-menu').not($(this.closest( "ul" ))).foundation('hideAll');
    // Adds Carrot symbol to active menu item only
        var activeMenu = $('.title-pill-carrot', this);
        $('.title-pill-carrot').not(activeMenu).addClass('hider');
        $(activeMenu).toggleClass('hider');
    });
    // Used if Menu Titles have links
    // $('.title-pill').click(function(e){
    //     $(this.parentElement.parentElement).foundation('showAll');
    // });
</script>

<script type="text/javascript">

    $(document).ready(function(){
        //       Search button logic *************
        $("#search-btn").click(function(){
            $( ".topicspan" ).addClass("topicspan-plus");
            $( this, "i" ).toggleClass( "fa-search fa-times" );
            $( "#search-sect" ).slideToggle();
            $( "#topic-sect-spacer" ).toggleClass( "topicspan searchbox-space" );
        });
        //       End Search button logic *************
        $("#mobile-nav-btn").click(function(){
            $( this ).children("i" ).toggleClass( "fa-bars fa-times" );
            $( "#mobile-dropdown-menu" ).slideToggle();
        });
        $(".mobile-sec-pills").click(function(){
            $( "#mobile-dropdown-menu" ).slideToggle();
            $( "#mobile-nav-btn" ).children( "i" ).toggleClass( "fa-bars fa-times" );
        });
    });
    
    
        var searchLocation = '';
        function setSearchPath(){
            if(window.location.hostname === '127.0.0.1'){
                if (window.location.pathname === '/topics/'){
                    searchLocation = '../search/';
                }else if (window.location.pathname === '/search/'){
                    searchLocation = './';
                }else{
                    searchLocation = '../../search/';
                }
            }else{
                if (window.location.pathname === '/core-support/topics/'){
                    searchLocation = '../search/';
                }else if (window.location.pathname === '/core-support/search/'){
                    searchLocation = './';
                }else{
                    searchLocation = '../../search/';
                }
            }
        }
        
        $(document.getElementById('search-input')).on('keyup', function (e) {
        if (e.keyCode == 13) {
            sessionStorage.setItem("searchTerm", document.getElementById('search-input').value);
            setSearchPath();
            console.log("SEARCHLOC: " + searchLocation)
            window.location.href = searchLocation;
        }
    });
    </script>
